---
const currentPath = Astro.url.pathname;

const navLinks = [
    { href: '/', label: 'Index' },
    { href: '/work', label: 'Selected Work' },
    { href: '/services', label: 'Expertise' },
    { href: '/about', label: 'Studio' },
    { href: '/contact', label: 'Contact' }
];
---

<nav class="nav" id="main-nav">
    <a href="/" class="logo-link" aria-label="SOAL Creations Home">
        <svg
            class="logo-svg"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="45 75 1090 300"
            aria-hidden="true"
        >
            <g class="logo-main" fill="currentColor">
                <path d="M168.1,367.08c-16.3,0-31.9-1.71-46.77-5.13-14.89-3.42-28.04-8.76-39.49-16.01-11.44-7.25-20.46-16.28-27.03-27.09-6.59-10.8-9.87-23.6-9.87-38.38,0-1.64.07-3.28.21-4.92.14-1.65.21-2.87.21-3.7h56.22c0,.55-.07,1.58-.21,3.08-.15,1.5-.21,2.81-.21,3.9,0,9.03,2.71,16.76,8.16,23.19,5.43,6.43,13.3,11.36,23.6,14.78,10.3,3.42,22.45,5.13,36.48,5.13,9.44,0,10.53-.55,17.82-1.65,7.3-1.09,13.58-2.66,18.88-4.72,5.29-2.05,9.66-4.51,13.09-7.39,3.43-2.87,5.93-6.09,7.5-9.65,1.57-3.55,2.37-7.39,2.37-11.49,0-7.93-2.58-14.5-7.73-19.7-5.15-5.19-12.09-9.58-20.81-13.13-8.73-3.55-18.6-6.77-29.61-9.64-11.02-2.87-22.32-5.81-33.9-8.82-11.59-3.01-22.89-6.63-33.9-10.88-11.02-4.24-20.89-9.37-29.61-15.39-8.73-6.01-15.67-13.61-20.82-22.78-5.15-9.17-7.72-20.17-7.72-33.04s2.93-24.63,8.8-34.48c5.86-9.85,14.16-17.99,24.89-24.42,10.73-6.43,23.24-11.22,37.55-14.37,14.31-3.14,29.89-4.72,46.78-4.72,15.73,0,30.54,1.58,44.42,4.72,13.87,3.14,26.1,8.07,36.69,14.77,10.59,6.71,18.88,15.19,24.89,25.45,6.01,10.27,9.01,22.51,9.01,36.73v4.93h-55.36v-4.11c0-7.93-2.51-14.63-7.51-20.11-5.01-5.47-12.02-9.71-21.03-12.72-9.01-3.01-19.52-4.51-31.54-4.51-12.87,0-23.89,1.17-33.05,3.48-9.16,2.33-16.17,5.75-21.03,10.27-4.87,4.51-7.29,10.06-7.29,16.62s2.57,12.58,7.72,17.23c5.15,4.66,12.08,8.62,20.81,11.91,8.72,3.28,18.59,6.3,29.61,9.03,11.01,2.74,22.32,5.68,33.9,8.83,11.59,3.14,22.89,6.77,33.9,10.88,11.01,4.1,20.88,9.23,29.61,15.39,8.72,6.15,15.67,13.75,20.82,22.78,5.15,9.03,7.72,19.85,7.72,32.43,0,21.07-5.36,38.04-16.09,50.9-10.73,12.86-25.47,22.16-44.21,27.91-18.74,5.75-32.84,8.62-56.88,8.62Z"/>
                <path d="M454.98,367.08c-30.62,0-57.08-5.27-79.39-15.8-22.32-10.53-39.42-26.61-51.28-48.22-11.87-21.62-17.81-48.84-17.81-81.68s5.93-60.4,17.81-81.89c11.87-21.48,28.97-37.48,51.28-48.02,22.31-10.53,48.78-15.8,79.39-15.8s48.88,5.27,71.05,15.8c22.17,10.54,39.2,26.54,51.07,48.02,11.87,21.49,17.81,48.78,17.81,81.89s-5.94,60.06-17.81,81.68c-11.87,21.62-28.9,37.69-51.07,48.22-22.18,10.54-40.15,15.8-71.05,15.8ZM454.98,321.93c14.87,0,19.41-2.05,30.72-6.16,11.3-4.11,20.81-10.19,28.53-18.26,7.73-8.07,13.59-18.06,17.6-29.96,4-11.9,6.01-25.65,6.01-41.25v-9.03c0-15.86-2-29.82-6.01-41.86-4.01-12.04-9.87-22.09-17.6-30.17-7.72-8.07-17.24-14.16-28.53-18.26-11.31-4.11-15.84-6.15-30.72-6.15s-27.97,2.05-39.27,6.15c-11.31,4.11-20.82,10.2-28.54,18.26-7.72,8.08-13.52,18.13-17.38,30.17-3.86,12.04-5.79,26-5.79,41.86v9.03c0,15.6,1.93,29.35,5.79,41.25,3.86,11.91,9.66,21.89,17.38,29.96s17.23,14.16,28.54,18.26c11.3,4.11,24.39,6.16,39.27,6.16Z"/>
                <path d="M910.33,362.15V80.6h55.79v229.87h159.75v51.68h-215.54Z"/>
                <path d="M887.88,80.6h-60.51l-23.6,59.92h-134.75l-23.6-59.92h-57.51l114.58,281.56h70.38l115.01-281.56ZM689,191.84h94.34l-27.21,70.16c-1.15,2.73-2.51,6.22-4.07,10.46-1.58,4.24-3.22,8.89-4.94,13.95-1.72,5.06-3.43,10.19-5.15,15.4-1.72,5.19-3.29,9.85-4.73,13.95h-2.15c-1.72-5.47-3.79-11.77-6.22-18.88-2.43-7.12-4.79-13.82-7.08-20.11-2.29-6.3-4.15-11.22-5.58-14.77l-27.21-70.16Z"/>
            </g>
        </svg>
    </a>

    <ul class="nav-links" id="nav-links">
        {navLinks.map(link => (
            <li>
                <a
                    href={link.href}
                    class:list={[{ active: currentPath === link.href || (link.href !== '/' && currentPath.startsWith(link.href)) }]}
                >
                    {link.label}
                </a>
            </li>
        ))}
    </ul>

    <button class="menu-btn" id="menu-btn" aria-label="Toggle menu" aria-expanded="false">
        <span class="menu-icon">
            <span></span>
            <span></span>
        </span>
        <span class="menu-text">Menu</span>
    </button>
</nav>

<!-- Mobile Menu Overlay -->
<div class="mobile-menu" id="mobile-menu" aria-hidden="true">
    <ul class="mobile-nav-links">
        {navLinks.map((link, index) => (
            <li style={`--delay: ${index * 0.1}s`}>
                <a
                    href={link.href}
                    class:list={[{ active: currentPath === link.href || (link.href !== '/' && currentPath.startsWith(link.href)) }]}
                >
                    {link.label}
                </a>
            </li>
        ))}
    </ul>
    <div class="mobile-menu-footer">
        <a href="mailto:hello@soalcreations.com">hello@soalcreations.com</a>
        <div class="mobile-socials">
            <a href="#">Instagram</a>
            <a href="#">LinkedIn</a>
        </div>
    </div>
</div>

<style>
    .nav {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        padding: 1.5rem 2rem;
        z-index: 1000;
        display: flex;
        justify-content: space-between;
        align-items: center;
        mix-blend-mode: difference;
        color: white;
        transition: padding 0.3s ease;
    }

    .nav.scrolled {
        padding: 1rem 2rem;
    }

    .logo-link {
        display: flex;
        align-items: center;
        text-decoration: none;
        z-index: 1001;
    }

    .logo-svg {
        width: 100px;
        height: auto;
        fill: currentColor;
        transition: transform 0.3s ease;
    }

    .logo-link:hover .logo-svg {
        transform: scale(1.05);
    }

    .nav-links {
        display: flex;
        gap: 2.5rem;
        list-style: none;
        margin: 0;
        padding: 0;
    }

    .nav-links a {
        font-size: 0.85rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        font-weight: 500;
        opacity: 0.7;
        position: relative;
        padding: 0.25rem 0;
        transition: opacity 0.3s ease;
    }

    .nav-links a::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 0;
        height: 1px;
        background: currentColor;
        transition: width 0.3s ease;
    }

    .nav-links a:hover,
    .nav-links a.active {
        opacity: 1;
    }

    .nav-links a:hover::after,
    .nav-links a.active::after {
        width: 100%;
    }

    .menu-btn {
        display: none;
        align-items: center;
        gap: 0.75rem;
        background: none;
        border: none;
        color: inherit;
        cursor: pointer;
        padding: 0.5rem;
        z-index: 1001;
        font-family: inherit;
    }

    .menu-icon {
        display: flex;
        flex-direction: column;
        gap: 6px;
        width: 24px;
    }

    .menu-icon span {
        display: block;
        height: 1.5px;
        background: currentColor;
        transition: transform 0.3s ease, opacity 0.3s ease;
    }

    .menu-icon span:first-child {
        width: 100%;
    }

    .menu-icon span:last-child {
        width: 60%;
    }

    .menu-btn.active .menu-icon span:first-child {
        transform: rotate(45deg) translate(5px, 5px);
    }

    .menu-btn.active .menu-icon span:last-child {
        transform: rotate(-45deg) translate(3px, -3px);
        width: 100%;
    }

    .menu-text {
        font-size: 0.85rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        font-weight: 500;
    }

    /* Mobile Menu Overlay */
    .mobile-menu {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100vh;
        height: 100dvh;
        background: var(--bg-color, #080808);
        z-index: 999;
        display: flex;
        flex-direction: column;
        justify-content: center;
        padding: 6rem 2rem 2rem;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.4s ease, visibility 0.4s ease;
    }

    .mobile-menu.active {
        opacity: 1;
        visibility: visible;
    }

    .mobile-nav-links {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .mobile-nav-links li {
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.4s ease, transform 0.4s ease;
        transition-delay: var(--delay, 0s);
    }

    .mobile-menu.active .mobile-nav-links li {
        opacity: 1;
        transform: translateY(0);
    }

    .mobile-nav-links a {
        display: block;
        font-size: clamp(2rem, 8vw, 3.5rem);
        font-weight: 300;
        padding: 0.75rem 0;
        color: var(--text-primary, #F2F2F2);
        opacity: 0.6;
        transition: opacity 0.3s ease, padding-left 0.3s ease;
    }

    .mobile-nav-links a:hover,
    .mobile-nav-links a.active {
        opacity: 1;
        padding-left: 1rem;
    }

    .mobile-menu-footer {
        margin-top: auto;
        padding-top: 2rem;
        border-top: 1px solid var(--border-light, rgba(255,255,255,0.1));
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.4s ease 0.5s, transform 0.4s ease 0.5s;
    }

    .mobile-menu.active .mobile-menu-footer {
        opacity: 1;
        transform: translateY(0);
    }

    .mobile-menu-footer a {
        color: var(--text-secondary, #888);
        font-size: 0.9rem;
    }

    .mobile-menu-footer a:hover {
        color: var(--text-primary, #F2F2F2);
    }

    .mobile-socials {
        display: flex;
        gap: 1.5rem;
        margin-top: 1rem;
    }

    @media (max-width: 900px) {
        .nav-links {
            display: none;
        }

        .menu-btn {
            display: flex;
        }

        .logo-svg {
            width: 80px;
        }
    }
</style>

<script>
    // Navigation functionality
    document.addEventListener('DOMContentLoaded', () => {
        const nav = document.getElementById('main-nav');
        const menuBtn = document.getElementById('menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');

        if (!menuBtn || !mobileMenu || !nav) return;

        // Toggle mobile menu
        menuBtn.addEventListener('click', () => {
            const isActive = mobileMenu.classList.contains('active');

            mobileMenu.classList.toggle('active');
            menuBtn.classList.toggle('active');
            menuBtn.setAttribute('aria-expanded', String(!isActive));
            mobileMenu.setAttribute('aria-hidden', String(isActive));

            // Prevent body scroll when menu is open
            document.body.style.overflow = isActive ? '' : 'hidden';
        });

        // Close menu on link click
        mobileMenu.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', () => {
                mobileMenu.classList.remove('active');
                menuBtn.classList.remove('active');
                menuBtn.setAttribute('aria-expanded', 'false');
                mobileMenu.setAttribute('aria-hidden', 'true');
                document.body.style.overflow = '';
            });
        });

        // Close menu on escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && mobileMenu.classList.contains('active')) {
                mobileMenu.classList.remove('active');
                menuBtn.classList.remove('active');
                menuBtn.setAttribute('aria-expanded', 'false');
                mobileMenu.setAttribute('aria-hidden', 'true');
                document.body.style.overflow = '';
            }
        });

        // Scroll behavior for nav
        let lastScroll = 0;
        window.addEventListener('scroll', () => {
            const currentScroll = window.scrollY;

            if (currentScroll > 50) {
                nav.classList.add('scrolled');
            } else {
                nav.classList.remove('scrolled');
            }

            lastScroll = currentScroll;
        }, { passive: true });
    });
</script>
